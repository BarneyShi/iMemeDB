(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{44:function(e,t,n){},45:function(e,t,n){},69:function(e,t,n){},70:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(17),c=n.n(o),l=(n(44),n(33)),m=n(34),i=n(39),s=n(38),u=n(9),d=n(4),p=(n(45),n(2)),g=n.n(p),E="GET_MEMES",f=function(){return function(e){g.a.get("/memes").then((function(t){return e((n=t.data,{type:E,payload:n}));var n}))}},h=n(71),v="UPVOTE",b=function(e){return function(t){var n=e.target.getAttribute("data-id"),a=(new h.a).get("token");g.a.post("/memes/".concat(n,"/upvote"),null,{headers:{Authorization:"Bearer "+a}}).then((function(e){return t((n=parseInt(e),{type:v,payload:n}));var n}))}},y="DOWNVOTE",_=function(e){return function(t){var n=e.target.getAttribute("data-id"),a=(new h.a).get("token");g.a.post("/memes/".concat(n,"/downvote"),null,{headers:{Authorization:"Bearer "+a}}).then((function(e){return t((n=parseInt(e),{type:y,payload:n}));var n}))}},w=n(5),O="LOGGEDIN",N="NOTLOGGEDIN",k=function(){return{type:N}},L=function(e){return function(t){g.a.get("/user/checkauth",{headers:{Authorization:"Bearer "+e}}).then((function(e){var n;200===e.status&&t((n=e.data.Data.username,{type:O,payload:n}))})).catch((function(e){if(e)throw console.log("Auth Error "),e;t(k)}))}},M="MEME_DELETED",j="MEME_NOT_DELETED",D={type:M},C={type:j},B=Object(w.b)((function(e){return{memesData:e.memes.memesData,isLoading:e.memes.isLoading,username:e.auth.username}}),(function(e){return{fetchMemes:function(){return e(f())},upvoteMeme:function(t){return e(b(t))},downvoteMeme:function(t){return e(_(t))},checkAuth:function(t){return e(L(t))},deleteMeme:function(t){return e(function(e){return function(t){var n=(new h.a).get("token");g.a.delete("/memes/".concat(e),{headers:{Authorization:"Bearer "+n}}).then((function(e){return t(D)})).catch((function(e){e&&t(C)}))}}(t))}}}))((function(e){e.dispatch;var t=e.checkAuth,n=e.memesData,o=e.isLoading,c=e.fetchMemes,l=e.upvoteMeme,m=e.downvoteMeme,i=e.username,s=e.deleteMeme;Object(a.useEffect)((function(){c()}),[n,c]);var d=new h.a;Object(a.useEffect)((function(){return t(d.get("token"))}),[d.get("token")]);var p=Object(u.g)(),g=function(e){null===i&&p.push("/login"),l(e)},E=function(e){m(e)},f=function(e){var t=e.target.getAttribute("data-id");s(t)};return r.a.createElement(a.Fragment,null,o?null:n.map((function(e,t){return r.a.createElement("div",{className:"col-md-4 col-sm-6 col-12",key:t},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h5",null,e.name)),r.a.createElement("img",{id:e._id,key:t,alt:"meme-img",className:"card-img-top",src:e.image}),r.a.createElement("div",{className:"card-body"},e.upvoted_users.includes(i)?r.a.createElement(a.Fragment,null,r.a.createElement("span",{id:"upvote_icon","data-id":e._id,onClick:g,role:"img","aria-label":"upvote",style:{textShadow:"0 0 0 #d39e00",color:"transparent"},"data-toggle":"modal","data-target":"#myModal"},"\ud83d\udc4d")," ",r.a.createElement("span",null,e.upvotes," ")):r.a.createElement(a.Fragment,null,r.a.createElement("span",{id:"upvote_icon","data-id":e._id,onClick:g,role:"img","aria-label":"upvote"},"\ud83d\udc4d")," ",r.a.createElement("span",null,e.upvotes," ")),e.downvoted_users.includes(i)?r.a.createElement(a.Fragment,null,r.a.createElement("span",{id:"downvote_icon","data-id":e._id,role:"img",onClick:E,"aria-label":"downvote",style:{textShadow:"0 0 0 #d39e00",color:"transparent"}},"\ud83d\udc4e"),r.a.createElement("span",null,e.downvotes," ")):r.a.createElement(a.Fragment,null,r.a.createElement("span",{id:"downvote_icon","data-id":e._id,onClick:E,role:"img","aria-label":"downvote"},"\ud83d\udc4e"),r.a.createElement("span",null,e.downvotes," ")),r.a.createElement("button",{style:{padding:"6px"},className:"btn btn-info",onClick:function(){p.push("memes/".concat(e._id))}},"Info"),e.author===i?r.a.createElement("button",{"data-id":e._id,onClick:f,style:{padding:"6px",marginLeft:"6px"},className:"btn btn-danger"},"Delete"):null)))})))})),S=(n(69),"POST_MEME"),I=function(){return{type:S}},A=Object(w.b)((function(e){return{isLogged:e.auth.isLogged_Main,username:e.auth.username}}),(function(e){return{postMeme:function(t){return e(function(e){return function(t){var n=new FormData(e.target),a=(new h.a).get("token");g.a.post("/memes",n,{headers:{Authorization:"Bearer "+a}}).then((function(){return t(I)}))}}(t))},checkAuth:function(t){return e(L(t))}}}))((function(e){var t=e.postMeme,n=(e.isPosted,e.isLogged),o=(e.username,e.checkAuth),c=new h.a;Object(a.useEffect)((function(){return o(c.get("token"))}),[c,o]);var l=Object(u.g)();return r.a.createElement("div",{id:"post_meme_form"},n?r.a.createElement(a.Fragment,null,r.a.createElement("h3",null,"POST MEME"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(e),l.push("/")}},r.a.createElement("input",{className:"d-block",placeholder:"Name",name:"name"}),r.a.createElement("input",{className:"d-block",placeholder:"Meme URL",name:"image"}),r.a.createElement("textarea",{className:"d-block",placeholder:"Description",name:"description"}),r.a.createElement("button",{className:"btn btn-primary"},"Submit"))):r.a.createElement(a.Fragment,null,r.a.createElement(u.a,{to:{pathname:"/login",state:{error:"Please sign in before posting memes",remind_to_login:!0}}})))})),T=Object(w.b)((function(e){return{isLogged:e.auth.isLogged_Main,username:e.auth.username}}))((function(e){var t=e.dispatch,n=e.isLogged,o=e.username,c=new h.a;Object(a.useEffect)((function(){return t(L(c.get("token")))}),[t,c]);return r.a.createElement("div",{id:"user_buttons"},n?r.a.createElement(a.Fragment,null,r.a.createElement("button",{className:"btn btn-warning",onClick:function(){c.remove("token",{path:"/"}),t(k),window.location.reload()}},"Logout"),r.a.createElement("span",null,"Hello, ",o)):r.a.createElement(a.Fragment,null,r.a.createElement(d.b,{to:"/register"},r.a.createElement("button",{className:"btn btn-danger"},"Register")),r.a.createElement(d.b,{to:"/login"},r.a.createElement("button",{className:"btn btn-success"},"Login"))))})),x="LOGGEDIN",F="NOT_LOGGEDIN",R=function(){return function(e){g.a.post("/user/login",{email:document.getElementById("email").value,password:document.getElementById("password").value}).then((function(t){var n;(new h.a).set("token",t.data.token,{path:"/"}),e((n=t.data.username,{type:x,payload:n}))})).catch((function(t){var n;t&&e({type:F,payload:n})}))}},G=Object(w.b)((function(e){return{isLoggedin:e.login.isLogged,user:e.login.user,attempt:e.login.attempt}}))((function(e){var t=e.dispatch,n=e.isLoggedin,o=(e.user,e.attempt),c=Object(u.h)(),l=Object(u.g)();Object(a.useEffect)((function(){n?l.goBack():o&&l.push({pathname:"/login"})}),[n,o,l]);return r.a.createElement("div",{id:"login_form"},c.state&&c.state.remind_to_login?r.a.createElement("p",{style:{color:"red",fontStyle:"italic"}},c.state.error):null,o?r.a.createElement(a.Fragment,null,r.a.createElement("p",{style:{color:"red",fontStyle:"italic"}},"Incorrect password/email")," "):null,r.a.createElement("h3",{style:{textAlign:"center"}},"Login"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(R())}},r.a.createElement("label",{htmlFor:"email"},"Email: "),r.a.createElement("input",{id:"email",name:"email",placeholder:"Email"}),r.a.createElement("label",{htmlFor:"password"},"Passowrd: "),r.a.createElement("input",{id:"password",name:"password",placeholder:"Password"}),r.a.createElement(d.b,{to:"/register"},r.a.createElement("p",null,"Don't have an account yet?")),r.a.createElement("button",{className:"btn btn-primary"},"Submit")))})),P="REGISTERED",U="NOT_REGISTER",z=function(){return function(e){g.a.post("/user/register",{username:document.getElementById("username").value,email:document.getElementById("email").value,password:document.getElementById("password").value}).then((function(t){return e((n=t.data,{type:P,payload:n}));var n}))}},V=Object(w.b)((function(e){return{isRegistered:e.register.isRegistered,user:e.register.user}}))((function(e){var t=e.dispatch,n=(e.isRegistered,e.user,Object(u.g)());return r.a.createElement("div",{id:"register_form"},r.a.createElement("h3",null,"Register"),r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),t(z()),n.push("/")}},r.a.createElement("label",{htmlFor:"username"},"Username"),r.a.createElement("input",{id:"username",name:"username",placeholder:"Username"}),r.a.createElement("label",{htmlFor:"email"},"Email"),r.a.createElement("input",{id:"email",name:"email",placeholder:"Email"}),r.a.createElement("label",{htmlFor:"password"},"Passowrd"),r.a.createElement("input",{id:"password",name:"password",placeholder:"Password"}),r.a.createElement(d.b,{to:"/login"},r.a.createElement("p",null,"Already have an account?")),r.a.createElement("button",{className:"btn btn-primary"},"Submit")))})),W="SUCCESS_COMMENT",J="FALIURE_COMMENT_LOGIN_NEED",H=function(e,t){return function(n){var a=(new h.a).get("token");g.a.post("/memes/".concat(t,"/comments"),{comment:e},{headers:{Authorization:"Bearer "+a}}).then((function(e){return n({type:W})})).catch((function(e){return n((t=e.message,{type:J,payload:t}));var t}))}},$="COMMENT_DELETE",q="COMMENT_DELETE_ERROR",K={type:$},Q={type:q},X=function(e){e.target.firstElementChild&&(e.target.firstElementChild.style.display="initial",e.target.firstElementChild.focus())},Y=function(){for(var e=document.getElementsByClassName("comment_delete_modal").length,t=0;t<e;t++)document.getElementsByClassName("comment_delete_modal")[t].style.display="none"},Z=Object(w.b)((function(e){return{memesData:e.memes.memesData,isLoading:e.memes.isLoading,username:e.auth.username,posted:e.comment.posted,failure:e.comment.failure,error_msg:e.comment.error_msg,comment_deleted:e.comment_deletion.comment_deleted}}),(function(e){return{fetchMemes:function(){return e(f())},checkAuth:function(t){return e(L(t))},postComment:function(t,n){return e(H(t,n))},deleteComment:function(t,n){return e(function(e,t){return function(n){var a=(new h.a).get("token");g.a.delete("/memes/".concat(e,"/comments/").concat(t),{headers:{Authorization:"Bearer "+a}}).then((function(e){return n(K)})).catch((function(e){e&&n(Q)}))}}(t,n))}}}))((function(e){var t=e.memesData,n=e.fetchMemes,o=e.username,c=e.match,l=e.postComment,m=e.posted,i=e.failure,s=e.error_msg,u=e.deleteComment;e.comment_deleted;Object(a.useEffect)((function(){n()}),[t,n]),Object(a.useEffect)((function(){i&&(document.getElementById("comment_error").innerText=s),null!=o&&i&&(document.getElementById("comment_error").innerText=""),m&&window.location.reload()}),[i,m,o]);var d=function(){var e=document.getElementById("comment_text").value;l(e,c.params.id)},p=function(e){var t=e.target.getAttribute("data-commentid"),n=e.target.getAttribute("data-memeid");u(n,t)};return r.a.createElement("div",{id:"meme_detail"},t.map((function(e,t){if(e._id.toString()===c.params.id)return r.a.createElement(a.Fragment,{key:t},r.a.createElement("div",{className:"col-12 col-sm-8 offset-sm-2"},r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-header"},r.a.createElement("h4",null,e.name)),r.a.createElement("img",{alt:"meme",key:t,src:e.image}),r.a.createElement("div",{className:"card-body"},r.a.createElement("p",{style:{fontStyle:"italic"}},"Description: \xa0",e.description),r.a.createElement("p",{style:{fontStyle:"italic"}},"Uploader: \xa0",e.author),r.a.createElement("p",{style:{fontStyle:"italic"}},"Date: \xa0",e.date.slice(0,10)," ")),r.a.createElement("div",{className:"card-body",id:"comment_section"},r.a.createElement("textarea",{id:"comment_text",onChange:function(){document.getElementById("comment_button").style.display="initial"},placeholder:"..Comment"})," ",r.a.createElement("p",{id:"comment_error",style:{color:"red",fontStyle:"italic"}}),r.a.createElement("input",{type:"button",value:"Submit",id:"comment_button",onClick:d}),e.comments.map((function(t,n){return r.a.createElement("p",{key:n},r.a.createElement("span",{id:"commenters"},t.commenter)," ",r.a.createElement("br",null)," ",t.commenter===o?r.a.createElement(a.Fragment,null,r.a.createElement("span",{onClick:X,style:{float:"right"}},"\xd7",r.a.createElement("span",{tabIndex:"0",onBlur:Y,className:"comment_delete_modal","data-commentid":t._id,"data-memeid":e._id,onClick:p},"Delete"))):null,r.a.createElement("span",{style:{fontSize:"0.75rem"}},"\ud83d\udd50 ",t.date.slice(0,10)),r.a.createElement("br",null),t.content)}))))))})))})),ee=function(e){Object(i.a)(n,e);var t=Object(s.a)(n);function n(){var e;Object(l.a)(this,n);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).exitButton=function(){document.getElementById("contact-form").style.display="none"},e.hiddenForm=function(){document.getElementById("contact-form").style.display="none",window.location.reload()},e}return Object(m.a)(n,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(T,null),r.a.createElement("div",{className:"jumbotron"},r.a.createElement("a",{href:"/"},r.a.createElement("img",{alt:"LOGO",src:"logo.png"}))),r.a.createElement("div",{style:{display:"flex",flexDirection:"row-reverse"}},r.a.createElement(d.b,{to:"/postmeme"},r.a.createElement("button",{className:"btn btn-success",id:"addButton"},"+ Add meme"))),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement(u.d,null,r.a.createElement(u.b,{path:"/register",component:V}),r.a.createElement(u.b,{path:"/login",component:G}),r.a.createElement(u.b,{path:"/postmeme",component:A}),r.a.createElement(u.b,{exact:!0,path:"/memes/:id",component:Z}))),r.a.createElement("div",{className:"row",style:{display:"inherit"}},r.a.createElement("div",{className:"card-deck"},r.a.createElement(u.d,null,r.a.createElement(u.b,{exact:!0,path:"/",component:B}))))),r.a.createElement("div",{style:{borderTop:"1px solid #0000001a",textAlign:"center"}},"\xa9 2020 Copyright - Barney Shi"))}}]),n}(a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var te=n(13),ne=n(37),ae=n(3),re={memesData:[],isLoading:!0},oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:re,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case E:return Object(ae.a)(Object(ae.a)({},e),{},{isLoading:!1,memesData:t.payload});default:return e}},ce={isPosted:!1},le=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ce,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case S:return Object(ae.a)(Object(ae.a)({},e),{},{isPosted:!0});default:return e}},me={isUpvoted:!1,upVotes:0},ie=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:return Object(ae.a)(Object(ae.a)({},e),{},{isUpvoted:!0,upVotes:t.payload});default:return e}},se={isDownvoted:!1,downVotes:0},ue=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:se,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return Object(ae.a)(Object(ae.a)({},e),{},{isDownvoted:!0});default:return e}},de={isLogged_Main:!1,username:null},pe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O:return{isLogged_Main:!0,username:t.payload};case N:return{isLogged_Main:!1,user:null};default:return e}},ge={isRegistered:!1,user:null},Ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ge,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case P:return{isRegistered:!0,user:t.payload};case U:return{isRegistered:!1};default:return e}},fe={isLogged:!1,username:[],attempt:!1},he=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:return{isLogged:!0};case F:return{isLogged:!1,username:null,attempt:!0};default:return e}},ve={posted:!1,failure:!1,error_msg:""},be=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ve,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case W:return{posted:!0,failure:!1,error_msg:"123"};case J:return Object(ae.a)(Object(ae.a)({},e),{},{failure:!0,posted:!1,error_msg:"Please sign in to comment"});default:return e}},ye={comment_deleted:!1},_e=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ye,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case $:return{comment_deleted:!0};case q:return{comment_deleted:!1};default:return e}},we={meme_deleted:!1},Oe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:we,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case M:return{meme_deleted:!0};case j:return{meme_deleted:!1};default:return e}},Ne=Object(te.c)({memes:oe,postmeme:le,upvotememe:ie,downvotememe:ue,auth:pe,register:Ee,login:he,comment:be,comment_deletion:_e,meme_deletion:Oe}),ke=Object(te.d)(Ne,Object(te.a)(ne.a));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(d.a,null,r.a.createElement(w.a,{store:ke},r.a.createElement(ee,null)))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[70,1,2]]]);
//# sourceMappingURL=main.24871709.chunk.js.map